# Headers

Заголовки HTTP предоставляют дополнительный способ передачи информации между клиентом и сервером. Есть заголовки, специфичные для запросов и ответов, а также общие заголовки для обоих. Заголовки могут иметь одно или несколько значений, добавленных после имени заголовка и разделенных двоеточием. Есть много заголовков, используемых для разных целей, которые разделены на разные категории:

1. General Headers
2. Entity Headers
3. Request Headers
4. Response Headers
5. Security Headers

## General Headers

Эти заголовки не относятся конкретно к запросу или ответу. Они контекстны и используются для описания сообщения, а не его содержания. Эта [ссылка](https://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html) предоставляет дополнительную информацию об общих заголовках.

| **Header** | **Description** |
| :--- | :--- |
| `Date` | Заголовок Date содержит дату и время, когда было отправлено сообщение. Предпочтительно преобразовывать время в стандартный [часовой пояс UTC](https://en.wikipedia.org/wiki/Coordinated_Universal_Time). |
| `Connection` | Заголовок Connection определяет, должно ли текущее сетевое соединение оставаться активным после завершения запроса. Два обычно используемых значения для этого заголовка - close и keep-alive. Значение закрытия либо от клиента, либо от сервера означает, что они хотели бы завершить соединение, в то время как заголовок keep-alive указывает, что соединение должно оставаться открытым. |

### **General Headers - Example**

```bash
k0n574n2@htb[/htb]$ curl -I -X GET https://www.inlanefreight.com

<SNIP>
Date: Sun, 06 Aug 2020 08:49:37 GMT
Connection: keep-alive
```

## Entity Headers

Подобно общим заголовкам, заголовки сущностей могут быть общими как для запроса, так и для ответа. Эти заголовки используются для описания содержимого \(сущности\), передаваемого сообщением. Обычно они находятся в ответах и запросах POST или PUT \(например, при загрузке файла\). Дополнительную информацию о заголовках сущностей можно найти [здесь](https://www.w3.org/Protocols/rfc2616/rfc2616-sec7.html).

| **Header** | **Description** |
| :--- | :--- |
| `Content-Type` | Этот заголовок используется для описания типа передаваемого ресурса. Значение автоматически добавляется браузерами на стороне клиента и возвращается в ответе сервера. |
| `Media-Type` | Тип носителя описывает передаваемые данные. Например, типом мультимедиа для PDF является application / pdf, а для изображения PNG - image / png. Этот заголовок может сыграть решающую роль в том, чтобы сервер интерпретировал наш ввод. Поле charset обозначает стандарт кодирования, например [UTF-8](https://en.wikipedia.org/wiki/UTF-8). |
| `Boundary` | Директива границы действует как создатель для разделения содержимого, когда в одном сообщении их несколько. |
| `Content-Length` | Заголовок Content-Length содержит размер передаваемого объекта. Этот заголовок необходим, поскольку сервер использует его для чтения данных из тела сообщения. |
| `Content-Encoding` | Перед передачей данные могут претерпевать несколько преобразований. Например, можно сжать большие объемы данных, чтобы уменьшить размер сообщения. Тип используемой кодировки должен быть указан с помощью заголовка Content-Encoding. |

### **Entity Headers - Example**

```bash
k0n574n2@htb[/htb]$ curl -I -X GET https://www.inlanefreight.com

<SNIP>
Content-Length: 26012
Content-Type: text/html; charset=ISO-8859-4
Content-Encoding: gzip
```

## Request Headers

Клиент отправляет заголовки запроса в транзакции HTTP. Они определены в [RFC 2616](https://tools.ietf.org/html/rfc2616). Эти заголовки используются в HTTP-запросе и не связаны с содержимым сообщения. Заголовки, такие как Accept, Accept-  _и IF-_ , допускают условные запросы. Заголовки, такие как Cookie или User-Agent, отправляются, чтобы сервер мог адаптировать ответ. Следующие заголовки обычно встречаются в HTTP-запросах. Полный список заголовков запросов и их использования можно найти [здесь](https://tools.ietf.org/html/rfc7231#section-5).

| **Header** | **Description** |
| :--- | :--- |
| `Host` | Заголовок Host используется для указания хоста, к которому запрашивается ресурс. Это может быть доменное имя или IP-адрес. HTTP-серверы могут быть настроены для размещения различных веб-сайтов, которые отображаются в зависимости от имени хоста. Это делает заголовок хоста важной целью перечисления. |
| `User-Agent` | Заголовок User-Agent используется для описания клиента, запрашивающего ресурсы. Например, браузер или библиотека. Этот заголовок может многое рассказать о клиенте, например о браузере, его версии и операционной системе. |
| `Accept` | Заголовок Accept описывает, какие типы мультимедиа может понять клиент. Он может содержать несколько типов мультимедиа, разделенных запятыми. Значение  _\*/\*_  обозначает все типы носителей. |
| `Cookie` | Заголовок cookie должен содержать пары cookie-значение в формате имя = значение. HTTP - это протокол без сохранения состояния, то есть сервер не может идентифицировать клиентов, подключающихся к нему. Это проблема при размещении защищенных ресурсов и контента. Файл cookie - это фрагмент данных, хранящийся на клиенте и сервере, который действует как идентификатор. Они передаются на сервер по запросу, таким образом поддерживая доступ клиента. Файлы [cookie](https://en.wikipedia.org/wiki/HTTP_cookie) также могут использоваться для других целей, например для сохранения пользовательских настроек или отслеживания сеансов. В одном заголовке может быть несколько файлов cookie, разделенных точкой с запятой. |
| `Referer` | Заголовок Referer указывает, откуда исходит текущий запрос. Например, щелчок по ссылке в результатах поиска Google сделает адресом ссылки [https://google.com](https://google.com). Доверять этому заголовку может быть опасно, так как им легко манипулировать, что приведет к непредвиденным последствиям. |
| `Authorization` | HTTP-заголовок авторизации - это еще один способ для сервера идентифицировать клиентов. После успешной аутентификации сервер возвращает токен, уникальный для клиента. В отличие от файлов cookie, токены хранятся только на стороне клиента и извлекаются сервером по запросу. Существует несколько типов аутентификации в зависимости от используемого веб-сервера и типа приложения. |

### **Request Headers - Example**

```bash
k0n574n2@htb[/htb]$ curl -I -X GET https://www.inlanefreight.com

Host: www.inlanefreight.com
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/605.1.15 (KHTML, like Gecko)
Cookie: cookie1=298zf09hf012fh2; cookie2=u32t4o3tb3gg4
Accept: text/plain
Referer: https://www.hackthebox.eu/
Authorization: BASIC cGFzc3dvcmQK
<SNIP>
```

## Response Headers

Заголовки ответа HTTP могут использоваться в ответе HTTP и не связаны с содержимым сообщения. Определенные заголовки ответа, такие как Возраст, Местоположение и Сервер, используются для предоставления более подробного контекста об ответе. Следующие заголовки обычно встречаются в ответах HTTP. [RFC 7231](https://tools.ietf.org/html/rfc7231#section-6) содержит более подробную информацию о заголовках ответов.

| **Header** | **Description** |
| :--- | :--- |
| `Server` | Заголовок Server содержит информацию о HTTP-сервере, обработавшем запрос. Его можно использовать для получения информации о сервере, например, его версии, и дальнейшего его перечисления. |
| `Set-Cookie` | Заголовок Set-Cookie содержит файлы cookie, необходимые для идентификации клиента. Браузеры анализируют файлы cookie и сохраняют их для будущих запросов. Этот заголовок имеет тот же формат, что и заголовок Cookie. |
| `WWW-Authenticate` | Заголовок WWW-Authenticate уведомляет клиента о типе аутентификации, необходимой для доступа к запрошенному ресурсу. |

### **Response Headers - Example**

```bash
k0n574n2@htb[/htb]$ curl -I -X GET https://www.inlanefreight.com

<SNIP>
Server: Apache/2.2.14 (Win32)
Set-Cookie: name1=value1,name2=value2; Expires=Wed, 09 Jun 2021 10:18:14 GMT
WWW-Authenticate: BASIC realm="localhost"
```

## Security Headers

С увеличением количества браузеров и атак через Интернет возникла необходимость определить определенные заголовки, повышающие безопасность. Заголовки безопасности HTTP - это класс заголовков ответов, используемых для указания определенных правил и политик, которым должен следовать браузер при доступе к веб-сайту.

[Проект безопасных заголовков OWASP](https://owasp.org/www-project-secure-headers/) - отличный ресурс для дальнейшего чтения о различных возможностях заголовков безопасности HTTP.

| **Header** | **Description** |
| :--- | :--- |
| `Content-Security-Policy` | Заголовок CSP определяет политику веб-сайта в отношении ресурсов, вводимых извне. Это может быть код JavaScript, а также ресурсы сценария. Этот заголовок указывает браузеру принимать ресурсы только из определенных доверенных доменов, что предотвращает такие атаки, как [межсайтовый скриптинг](https://en.wikipedia.org/wiki/Cross-site_scripting). |
| `Strict-Transport-Security` | Политика HTTP Strict Transport Security веб-сайта предотвращает доступ браузера к веб-сайту по протоколу HTTP с открытым текстом. Все коммуникации осуществляются через защищенный протокол HTTPS. Это не позволяет злоумышленникам перехватить веб-трафик и получить доступ к защищенной информации, такой как пароли или другие конфиденциальные данные. |
| `Referrer-Policy` | Этот заголовок определяет, должен ли браузер включать значение, указанное в заголовке Referer, или нет. Это может помочь избежать раскрытия конфиденциальных URL-адресов и информации при просмотре веб-сайта. |

### **Security Headers - Example**

```bash
k0n574n2@htb[/htb]$ curl -I -X GET https://www.inlanefreight.com

<SNIP>
Content-Security-Policy: script-src 'self'
Strict-Transport-Security: max-age=31536000
Referrer-Policy: origin
```

{% hint style="info" %}
В приведенном выше разделе содержится небольшой список часто встречающихся заголовков HTTP. Однако есть гораздо больше контекстных заголовков, которые можно использовать во время общения. Приложения также могут определять собственные заголовки в зависимости от своих требований. Полный список стандартных заголовков HTTP можно найти [здесь](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers).
{% endhint %}



